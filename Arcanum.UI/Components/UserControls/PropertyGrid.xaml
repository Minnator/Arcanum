<UserControl x:Class = "Arcanum.UI.Components.UserControls.PropertyGrid"
             xmlns = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x = "http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:uc = "clr-namespace:Arcanum.UI.Components.UserControls"
             xmlns:base = "clr-namespace:Arcanum.UI.Components.Base.StyleClasses"
             xmlns:conv = "clr-namespace:Arcanum.UI.Components.Base.Converters">


    <UserControl.Resources>
        <conv:EnumValuesConverter x:Key = "EnumValuesConverter" />
        <conv:DecimalDoubleConverter x:Key = "DecimalDoubleConverter" />

        <DataTemplate x:Key = "StringTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <TextBox Text = "{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     Style = "{StaticResource BaseTextBoxStyle}"
                     Margin = "0, 0, 6, 0"
                     VerticalAlignment = "Center"
                     HorizontalAlignment = "Stretch"
                     BorderThickness = "0"
                     Background = "Transparent"
                     TextWrapping = "NoWrap" />
        </DataTemplate>

        <DataTemplate x:Key = "BoolTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <CheckBox IsChecked = "{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                      Style = "{StaticResource BaseCheckBox}" />
        </DataTemplate>

        <DataTemplate x:Key = "EnumTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <ComboBox ItemsSource = "{Binding Type, Converter={StaticResource EnumValuesConverter}}"
                      SelectedItem = "{Binding Value, Mode=TwoWay}"
                      DisplayMemberPath = "."
                      Style = "{StaticResource BorderlessComboboxStyle}"
                      Margin = "1"
                      Background = "Transparent" />
        </DataTemplate>

        <DataTemplate x:Key = "DefaultTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <TextBlock Text = "{Binding Value}"
                       Width = "150"
                       Margin = "1" />
        </DataTemplate>

        <DataTemplate x:Key = "IntTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <uc:BaseNumericUpDown Value = "{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  Margin = "0, 0, 6, 0"
                                  Background = "Transparent"
                                  BorderThickness = "0"
                                  Padding = "0"
                                  HorizontalAlignment = "Stretch"
                                  VerticalAlignment = "Stretch" />
        </DataTemplate>

        <DataTemplate x:Key = "DecimalTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <uc:DecimalBaseNumericUpDown
                Value = "{Binding Value, Mode=TwoWay, Converter={StaticResource DecimalDoubleConverter}}"
                Margin = "0, 0, 6, 0"
                Background = "Transparent"
                BorderThickness = "0"
                Padding = "0"
                HorizontalAlignment = "Stretch"
                VerticalAlignment = "Stretch" />
        </DataTemplate>

        <DataTemplate x:Key = "FloatTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <uc:FloatNumericUpDown Value = "{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                   Margin = "0, 0, 6, 0"
                                   Background = "Transparent"
                                   BorderThickness = "0"
                                   Padding = "0"
                                   HorizontalAlignment = "Stretch"
                                   VerticalAlignment = "Stretch" />
        </DataTemplate>

        <DataTemplate x:Key = "ObjectTemplate"
                      DataType = "{x:Type base:PropertyItem}">

            <Grid Margin = "3, 0, 6, 0"
                  HorizontalAlignment = "Stretch"
                  VerticalAlignment = "Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width = "1*" />
                    <ColumnDefinition Width = "20" />
                </Grid.ColumnDefinitions>

                <TextBlock Text = "{Binding Type}"
                           Margin = "2, 0, 0, 0"
                           VerticalAlignment = "Center"
                           HorizontalAlignment = "Left"
                           Style = "{StaticResource BaseTextBlock}" />

                <base:BaseButton Grid.Column = "1"
                                 Margin = "2"
                                 Padding = "0"
                                 Style = "{StaticResource BaseDarkButtonStyle}"
                                 VerticalAlignment = "Stretch"
                                 Click = "ViewObject_Button_Click"
                                 HorizontalAlignment = "Stretch">
                    <Image Source = "../../Assets/Icons/Eye20x20.png"
                           VerticalAlignment = "Center"
                           HorizontalAlignment = "Center"
                           Stretch = "UniformToFill"
                           Margin = "0" />
                </base:BaseButton>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key = "CollectionTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <Grid Margin = "3, 0, 6, 0"
                  HorizontalAlignment = "Stretch"
                  VerticalAlignment = "Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width = "1*" />
                    <ColumnDefinition Width = "20" />
                </Grid.ColumnDefinitions>

                <TextBlock Text = "{Binding CollectionDescription}"
                           Margin = "2, 0, 0, 0"
                           VerticalAlignment = "Center"
                           HorizontalAlignment = "Left"
                           Style = "{StaticResource BaseTextBlock}" />

                <base:BaseButton Grid.Column = "1"
                                 Margin = "2"
                                 Padding = "0"
                                 Style = "{StaticResource BaseDarkButtonStyle}"
                                 VerticalAlignment = "Stretch"
                                 Click = "ViewCollection_Button_Click"
                                 HorizontalAlignment = "Stretch">
                    <Image Source = "../../Assets/Icons/Eye20x20.png"
                           VerticalAlignment = "Center"
                           HorizontalAlignment = "Center"
                           Stretch = "UniformToFill"
                           Margin = "0" />
                </base:BaseButton>
            </Grid>
        </DataTemplate>


        <uc:PropertyEditorTemplateSelector x:Key = "PropertyEditorSelector"
                                           StringTemplate = "{StaticResource StringTemplate}"
                                           BoolTemplate = "{StaticResource BoolTemplate}"
                                           EnumTemplate = "{StaticResource EnumTemplate}"
                                           IntTemplate = "{StaticResource IntTemplate}"
                                           DecimalTemplate = "{StaticResource DecimalTemplate}"
                                           FloatTemplate = "{StaticResource FloatTemplate}"
                                           CollectionTemplate = "{StaticResource CollectionTemplate}"
                                           ObjectTemplate = "{StaticResource ObjectTemplate}"
                                           DefaultTemplate = "{StaticResource DefaultTemplate}" />


        <DataTemplate x:Key = "PropertyRowTemplate"
                      DataType = "{x:Type base:PropertyItem}">
            <Grid HorizontalAlignment = "Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition
                        Width = "{Binding LabelWidth, RelativeSource={RelativeSource AncestorType={x:Type uc:PropertyGrid}}}" />
                    <ColumnDefinition Width = "7" />
                    <ColumnDefinition Width = "1*" />

                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height = "20" />
                    <RowDefinition Height = "3" />
                </Grid.RowDefinitions>

                <TextBlock Grid.Row = "0"
                           Grid.Column = "0"
                           Style = "{StaticResource BaseTextBlock}"
                           Text = "{Binding Name}"
                           VerticalAlignment = "Center"
                           Margin = "7, 0, 0, 0" />

                <Rectangle Grid.Row = "0"
                           Grid.Column = "1"
                           Width = "1"
                           Margin = "3"
                           Fill = "{StaticResource LightBackColorBrush}" />

                <Border x:Name = "Border"
                        Grid.Row = "0"
                        Grid.Column = "2"
                        Background = "Transparent"
                        CornerRadius = "3">
                    <ContentPresenter Content = "{Binding}"
                                      ContentTemplateSelector = "{StaticResource PropertyEditorSelector}" />

                </Border>

                <Rectangle Grid.Row = "1"
                           Grid.Column = "0"
                           Grid.ColumnSpan = "3"
                           Height = "1"
                           Fill = "{StaticResource LightBackColorBrush}"
                           Margin = "6,0" />
            </Grid>
        </DataTemplate>

    </UserControl.Resources>

    <Border CornerRadius = "3"
            BorderBrush = "{StaticResource DefaultBorderColorBrush}"
            BorderThickness = "2"
            Margin = "{Binding Margin, RelativeSource={RelativeSource AncestorType=UserControl}}"
            Background = "{StaticResource DefaultBackColorBrush}"
            VerticalAlignment = "Stretch"
            HorizontalAlignment = "Stretch">
        <Grid>
            <Grid.Resources>
                <Style TargetType = "{x:Type Grid}">
                    <Setter Property = "Background"
                            Value = "{StaticResource DefaultBackColorBrush}" />
                </Style>
            </Grid.Resources>
            <Grid.RowDefinitions>
                <RowDefinition Height = "24" />
                <RowDefinition Height = "1*" />
                <RowDefinition Height = "Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width = "1*" />
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row = "0"
                       Text = "{Binding Title, RelativeSource={RelativeSource AncestorType=UserControl}}"
                       FontWeight = "Bold"
                       Margin = "0"
                       Padding = "5,0"
                       FontSize = "16"
                       Foreground = "{StaticResource DefaultForeColorBrush}"
                       Background = "{StaticResource LightBackColorBrush}"
                       HorizontalAlignment = "Stretch"
                       VerticalAlignment = "Stretch" />

            <ListBox x:Name = "PropertyList"
                     Grid.Row = "1"
                     Style = "{StaticResource BaseListBox}"
                     ItemsSource = "{Binding Properties, RelativeSource={RelativeSource AncestorType=UserControl}}"
                     ItemTemplate = "{StaticResource PropertyRowTemplate}"
                     BorderThickness = "0"
                     Margin = "0"
                     Padding = "0, 0, -12, 0"
                     Background = "{StaticResource DefaultBackColorBrush}"
                     ScrollViewer.VerticalScrollBarVisibility = "Auto"
                     ScrollViewer.HorizontalScrollBarVisibility = "Disabled"
                     HorizontalContentAlignment = "Stretch" />

            <Grid Grid.Row = "2"
                  MinHeight = "40"
                  Margin = "2"
                  Background = "Transparent">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width = "*" />
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height = "2" />
                    <RowDefinition Height = "1*" />
                </Grid.RowDefinitions>

                <Rectangle Grid.Row = "0"
                           Height = "2"
                           Fill = "{StaticResource LightBackColorBrush}"
                           Margin = "3, 0"
                           HorizontalAlignment = "Stretch"
                           VerticalAlignment = "Stretch" />

                <TextBlock Grid.Row = "1"
                           Margin = "4"
                           Style = "{StaticResource BaseTextBlock}"
                           Text = "{Binding Description, RelativeSource={RelativeSource AncestorType=UserControl}}">
                </TextBlock>
            </Grid>

        </Grid>
    </Border>
</UserControl>